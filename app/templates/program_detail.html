{% extends "base.html" %}

{% block title %}{{ program.name }} | Eidikos Global Events{% endblock %}
{% block description %}{{ program.excerpt if program.excerpt else (program.description[:160] if program.description else
'Eidikos Global Events program detail.') }}{% endblock %}

{% block content %}
<!-- PROGRAM HERO -->
<section class="program-hero"
    style="background: linear-gradient(135deg, var(--primary), var(--secondary)); padding: 120px 0 80px; color: white; text-align: center;">
    <div class="container">
        <div class="program-badge"
            style="display: inline-block; padding: 5px 15px; background: rgba(255,255,255,0.2); border-radius: 20px; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 20px;">
            {{ program.type|replace('_', ' ')|upper }}
        </div>
        <h1 style="font-size: 3.5rem; margin-bottom: 20px; font-family: 'Playfair Display', serif;">{{ program.name|safe
            }}</h1>
        <p class="lead" style="font-size: 1.25rem; max-width: 800px; margin: 0 auto; opacity: 0.9;">{{
            program.excerpt|safe if program.excerpt else '' }}</p>
    </div>
</section>

<!-- MAIN CONTENT -->
<section class="program-main" style="padding: 80px 0;">
    <div class="container">
        <div class="row" style="display: flex; flex-wrap: wrap; gap: 40px;">
            <!-- Content Left -->
            <div class="col-main" style="flex: 2; min-width: 300px;">
                <div class="program-description" style="margin-bottom: 50px;">
                    <h2 style="color: var(--primary); margin-bottom: 25px; font-family: 'Playfair Display', serif;">
                        About the Program</h2>
                    <div style="line-height: 1.8; color: #444; font-size: 1.1rem;">
                        {{ program.description|safe if program.description else 'Full description coming soon.' }}
                    </div>
                </div>

                {% if program.subcontents is defined and program.subcontents %}
                <div class="program-subcontents">
                    <h3
                        style="color: var(--primary); margin-bottom: 30px; border-bottom: 2px solid var(--accent); display: inline-block; padding-bottom: 5px;">
                        Key Details</h3>
                    <div class="subcontents-grid"
                        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-top: 20px;">
                        {% for item in program.subcontents %}
                        <div class="subcontent-item"
                            style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); border-left: 4px solid var(--gold);">
                            <h4 style="color: var(--secondary); margin-bottom: 15px; font-size: 1.25rem;">{{
                                item.title|safe }}</h4>
                            <div style="color: #666; line-height: 1.6;">{{ item.content|safe }}</div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>

            <!-- Sidebar Right -->
            <div class="col-sidebar" style="flex: 1; min-width: 280px;">
                <div class="sidebar-card"
                    style="background: #f9f9f9; padding: 30px; border-radius: 15px; position: sticky; top: 100px;">
                    {% if program.image_filename %}
                    <div
                        style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 25px; border: 1px solid #eee;">
                        <img src="{{ url_for('static', filename='uploads/programs/' + program.image_filename) }}"
                            alt="{{ program.name }}" style="width: 100%; height: auto; display: block;">
                    </div>
                    {% elif program.icon %}
                    <div style="text-align: center; font-size: 4rem; color: var(--gold); margin-bottom: 20px;">
                        <i class="{{ program.icon }}"></i>
                    </div>
                    {% endif %}

                    <h4 style="margin-bottom: 15px; color: var(--primary);">Join This Program</h4>
                    <p style="color: #666; font-size: 0.95rem; margin-bottom: 25px;">Ready to excel? Register now or
                        contact our team for more information about the next intake.</p>

                    {% if program.cta_url %}
                    <a href="{{ program.cta_url }}" class="btn btn-gold w-100"
                        style="display: block; text-align: center; text-decoration: none; padding: 15px; border-radius: 8px; font-weight: 700;">
                        {{ program.cta_text if program.cta_text else 'Register Now' }}
                    </a>
                    {% else %}
                    <a href="{{ url_for('main.contact', type=program.type, program=program.name) }}"
                        class="btn btn-gold w-100"
                        style="display: block; text-align: center; text-decoration: none; padding: 15px; border-radius: 8px; font-weight: 700;">
                        Register Interest
                    </a>
                    {% endif %}

                    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd;">
                        <p style="font-size: 0.85rem; color: #888;">Share this program:</p>
                        <div class="share-links" style="display: flex; gap: 15px; margin-top: 10px;">
                            <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.url|urlencode }}"
                                target="_blank" style="color: #3b5998;" title="Share on Facebook">
                                <i class="fab fa-facebook fa-lg"></i>
                            </a>
                            <a href="https://twitter.com/intent/tweet?text={{ program.name|urlencode }}&url={{ request.url|urlencode }}"
                                target="_blank" style="color: #1da1f2;" title="Share on Twitter">
                                <i class="fab fa-twitter fa-lg"></i>
                            </a>
                            <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ request.url|urlencode }}"
                                target="_blank" style="color: #0077b5;" title="Share on LinkedIn">
                                <i class="fab fa-linkedin fa-lg"></i>
                            </a>
                            <a href="https://api.whatsapp.com/send?text={{ program.name|urlencode }}%20{{ request.url|urlencode }}"
                                target="_blank" style="color: #25d366;" title="Share on WhatsApp">
                                <i class="fab fa-whatsapp fa-lg"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{% if gallery_items %}
<!-- PROGRAM GALLERY -->
<section class="program-gallery" style="padding: 80px 0; background: #fff;">
    <div class="container">
        <div class="section-header" style="margin-bottom: 40px; text-align: center;">
            <h2 style="font-family: 'Playfair Display', serif; color: var(--primary);">Program Highlights</h2>
            <p style="color: #666;">Photos and videos from our recent activities.</p>
        </div>

        <div class="gallery-grid"
            style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px;">
            {% for item in gallery_items %}
            <div class="gallery-item"
                style="position: relative; overflow: hidden; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); height: 250px;">
                {% if item.video_url %}
                <div class="video-container" style="height: 100%;">
                    <iframe src="{{ item.video_url|youtube_embed }}" style="width: 100%; height: 100%; border: 0;"
                        allowfullscreen></iframe>
                </div>
                {% else %}
                <img src="{{ url_for('static', filename='uploads/gallery/' + item.image_filename) }}"
                    alt="{{ item.title }}" style="width: 100%; height: 100%; object-fit: cover;">
                {% endif %}
                {% if item.title %}
                <div class="gallery-caption"
                    style="position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.7); color: white; padding: 10px; font-size: 0.9rem; transform: translateY(100%); transition: transform 0.3s ease;">
                    {{ item.title }}
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<style>
    .gallery-item:hover .gallery-caption {
        transform: translateY(0);
    }
</style>
{% endif %}

{% if related_programs %}
<!-- RELATED PROGRAMS -->
<section class="related-programs" style="padding: 80px 0; background: #f4f7f9;">
    <div class="container">
        <div class="section-header" style="margin-bottom: 40px;">
            <h2 style="font-family: 'Playfair Display', serif; color: var(--primary);">More {{ program.type|replace('_',
                ' ')|capitalize }} Programs</h2>
        </div>
        <div class="grid-3">
            {% for program in related_programs %}
            {% include 'partials/program_card.html' %}
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<style>
    .btn-gold {
        background-color: var(--gold);
        color: var(--primary);
        transition: all 0.3s ease;
    }

    .btn-gold:hover {
        background-color: var(--primary);
        color: white;
        transform: translateY(-2px);
    }

    .w-100 {
        width: 100%;
    }
</style>
{% endblock %}